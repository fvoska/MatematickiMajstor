<!DOCTYPE html>
<html>
<head lang="en">
	<link href="bootstrap/css/bootstrap.min.css" rel="stylesheet">
	<script src="bootstrap/js/bootstrap.min.js"></script>
    <meta charset="UTF-8">
    <script src="//cdn.socket.io/socket.io-1.2.1.js"></script>
    <script src="//code.jquery.com/jquery-2.1.1.min.js"></script>
    <script type="text/javascript">
        var socket = io.connect('127.0.0.1:8080');

        socket.on('connect', function(){
            socket.emit('adduser', prompt("What's your name: "));
        });

        socket.on('updatechat', function (username, data) {
            $('#conversation').append('<b>'+ username + ':</b> ' + data + '<br>');
        });


        socket.on('updaterooms', function (rooms, current_room) {
            $('#rooms').empty();
            $.each(rooms, function(key, value) {
                if(value == current_room){
                    $('#rooms').append('<div>' + value + '</div>');
                }
                else {
                    $('#rooms').append('<div><a href="#" onclick="switchRoom(\''+value+'\')">' + value + '</a></div>');
                }
            });
        });

        function switchRoom(room){
            socket.emit('switchRoom', room);
        }

        $(function(){
            $('#datasend').click( function() {
                var message = $('#data').val();
                $('#data').val('');
                socket.emit('sendchat', message);
            });

            $('#data').keypress(function(e) {
                if(e.which == 13) {
                    $(this).blur();
                    $('#datasend').focus().click();
                }
            });

            $('#roombutton').click(function(){
                var name = $('#roomname').val();
                $('#roomname').val('');
                socket.emit('switchRoom', name);
            });
        });

    </script>
    <title></title>
</head>
<body>
<div style="margin:auto;padding:10px;padding-top:20px;width:1300px;height:600px;margin-top:25px;">
<div class="panel panel-primary" style="position: relative;float:left;left: 20px;text-align: center; width:200px;height:550px;padding:10px;">
    <div class="panel-heading">
    <center><h3 class="panel-title">SOBE</h3></center>
	</div>
	<br>
    <div><a href="#" onclick="switchRoom('Lobby')">Lobby</a></div>
    <div id="rooms"></div>
</div>
<div class="panel panel-primary" style="position: relative;float:left; left:35px;width:800px; height:550px;">
<div class="login-container" style="width:350px; position:relative; margin:auto; margin-top:240px;">
    <div class="panel panel-default login" id="room creation">
	<div class="panel-body">
    <form class="form-inline" role="form">
		<div class="form-group">
			<div class="input-group">
				<label class="sr-only" for="roomname">Ime sobe</label>
			<input class="form-control" id="roomname" placeholder="Upiši ime sobe">
			</div>
		</div>
		<button type="submit" id="roombutton" class="btn btn-primary">Napravi sobu</button>
	</form>
	</div>
	</div>
</div>
</div>
<div class="panel panel-primary" style="position: relative; float:left; left:50px; width:200px; height:550px;padding:10px;">    
	<div class="panel-heading">
    <center><h3 class="panel-title">RAZGOVOR</h3></center>
	</div>
	<br>
	<div> 
    <div class="input-group">
     <input type="text" class="form-control" id="data">
      <span class="input-group-btn">
        <button class="btn btn-primary" type="button" id="datasend">Pošalji</button>
      </span>
    </div><!-- /input-group -->
  </div><!-- /.col-lg-6 -->
  <br>
  <textarea class="form-control" style="height:400px;"></textarea>
</div>
</div>
</body>
</html>